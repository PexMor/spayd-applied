import{G as ke,h as g,p as E,o as e,q as xe,s as Pe,b as Ce,k as R,B as De}from"./browser-11a39654.js";const Be={settings:"NastavenÃ­",globalSettings:"GlobÃ¡lnÃ­ nastavenÃ­",webhookUrl:"Webhook URL",webhookUrlPlaceholder:"https://priklad.cz/webhook",webhookUrlHelp:"URL kam budou zasÃ­lÃ¡ny notifikace o platbÃ¡ch (POST poÅ¾adavek)",immediateSync:"OkamÅ¾itÃ¡ synchronizace",immediateSyncHelp:"Odeslat notifikaci o platbÄ› ihned po vygenerovÃ¡nÃ­",saved:"UloÅ¾eno",failedToSave:"NepodaÅ™ilo se uloÅ¾it",appTitle:"SPAYD GenerÃ¡tor Plateb",appSubtitle:"SystÃ©m pro generovÃ¡nÃ­ QR kÃ³dÅ¯ plateb s vÃ­ce ÃºÄty",tabGenerate:"Generovat",tabAccounts:"ÃšÄty",tabEvents:"UdÃ¡losti",tabHistory:"Historie",tabSync:"Synchronizace",add:"PÅ™idat",edit:"Upravit",delete:"Smazat",cancel:"ZruÅ¡it",create:"VytvoÅ™it",update:"Aktualizovat",save:"UloÅ¾it",close:"ZavÅ™Ã­t",view:"Zobrazit",default:"VÃ½chozÃ­",optional:"VolitelnÃ©",required:"PovinnÃ©",accounts:"BankovnÃ­ ÃšÄty",addAccount:"+ PÅ™idat ÃšÄet",editAccount:"Upravit ÃšÄet",accountName:"NÃ¡zev ÃšÄtu",accountNamePlaceholder:"napÅ™. HlavnÃ­ FiremnÃ­ ÃšÄet",iban:"IBAN",ibanPlaceholder:"CZ6508000000192000145399",ibanHelp:"Zadejte IBAN bez mezer (napÅ™. CZ6508000000192000145399)",currency:"MÄ›na",setAsDefault:"Nastavit jako vÃ½chozÃ­ ÃºÄet",noAccountsYet:"ZatÃ­m Å¾Ã¡dnÃ© ÃºÄty",noAccountsMessage:"PÅ™idejte svÅ¯j prvnÃ­ bankovnÃ­ ÃºÄet pro zaÄÃ¡tek generovÃ¡nÃ­ plateb",deleteAccountConfirm:"Opravdu chcete smazat ÃºÄet",events:"PlatebnÃ­ UdÃ¡losti",addEvent:"+ PÅ™idat UdÃ¡lost",editEvent:"Upravit UdÃ¡lost",eventName:"NÃ¡zev UdÃ¡losti",eventNamePlaceholder:"napÅ™. Workshop 2024",staticSymbol:"StatickÃ½ Symbol (SS)",staticSymbolPlaceholder:"napÅ™. 543",staticSymbolHelp:"IdentifikÃ¡tor udÃ¡losti, kterÃ½ zÅ¯stÃ¡vÃ¡ konstantnÃ­ pro vÅ¡echny platby",variableSymbolMode:"ReÅ¾im VariabilnÃ­ho Symbolu",vsModeCounter:"ÄŒÃ­taÄ (SekvenÄnÃ­: 1, 2, 3...)",vsModeTime:"ÄŒasovÃ½ (YYYYMMDDHHmmss)",vsModeStatic:"StatickÃ½ (StejnÃ¡ hodnota)",startingCounter:"PoÄÃ¡teÄnÃ­ Hodnota ÄŒÃ­taÄe",staticVsValue:"StatickÃ¡ Hodnota VS",staticVsValuePlaceholder:"napÅ™. 123456",permanentAmount:"TrvalÃ¡ ÄŒÃ¡stka",permanentAmountPlaceholder:"napÅ™. 450.00",permanentAmountHelp:"Nastavte opakujÃ­cÃ­ se ÄÃ¡stku pro rychlÃ© generovÃ¡nÃ­ plateb",setAsDefaultEvent:"Nastavit jako vÃ½chozÃ­ udÃ¡lost",noEventsYet:"ZatÃ­m Å¾Ã¡dnÃ© udÃ¡losti",noEventsMessage:"VytvoÅ™te svou prvnÃ­ platebnÃ­ udÃ¡lost pro organizaci plateb",deleteEventConfirm:"Opravdu chcete smazat udÃ¡lost",generatePayment:"Generovat Platbu",selection:"VÃ½bÄ›r",account:"ÃšÄet",event:"UdÃ¡lost",selectedConfiguration:"VybranÃ¡ Konfigurace",paymentDetails:"Detaily Platby",usePermanentAmount:"PouÅ¾Ã­t trvalou ÄÃ¡stku",amount:"ÄŒÃ¡stka",amountPlaceholder:"napÅ™. 450.00",message:"ZprÃ¡va",messagePlaceholder:"napÅ™. RegistraÄnÃ­ poplatek",quickGenerate:"âš¡ RychlÃ© GenerovÃ¡nÃ­",generatedPayment:"VygenerovanÃ¡ Platba",variableSymbol:"VariabilnÃ­ Symbol",setupRequired:"NutnÃ¡ Konfigurace",setupRequiredMessage:"ProsÃ­m vytvoÅ™te alespoÅˆ jeden ÃºÄet a jednu udÃ¡lost pÅ™ed generovÃ¡nÃ­m plateb.",noPaymentGenerated:"ZatÃ­m nebyla vygenerovÃ¡na Å¾Ã¡dnÃ¡ platba",noPaymentMessage:"VyplÅˆte formulÃ¡Å™ a kliknÄ›te na generovat pro vytvoÅ™enÃ­ QR kÃ³du platby",downloadQr:"ðŸ’¾ StÃ¡hnout QR",generateAnother:"âœ¨ Generovat DalÅ¡Ã­",copyToClipboard:"KopÃ­rovat",copiedToClipboard:"ZkopÃ­rovÃ¡no do schrÃ¡nky!",paymentHistory:"Historie Plateb",filters:"Filtry",allAccounts:"VÅ¡echny ÃšÄty",allEvents:"VÅ¡echny UdÃ¡losti",noPaymentsFound:"Nenalezeny Å¾Ã¡dnÃ© platby",noPaymentsMessage:"Vygenerujte svou prvnÃ­ platbu pro zobrazenÃ­ zde",date:"Datum",selectPayment:"Vyberte platbu",selectPaymentMessage:'KliknÄ›te na "Zobrazit" u platby pro zobrazenÃ­ detailÅ¯',downloadQrCode:"ðŸ’¾ StÃ¡hnout QR KÃ³d",deletePaymentConfirm:"Opravdu chcete smazat tuto platbu?",syncQueue:"Fronta Synchronizace",retryFailed:"ðŸ”„ Opakovat NeÃºspÄ›Å¡nÃ©",processQueue:"â–¶ï¸ Zpracovat Frontu",processing:"ZpracovÃ¡vÃ¡nÃ­...",pending:"ÄŒekÃ¡",sent:"OdeslÃ¡no",failed:"NeÃºspÄ›Å¡nÃ©",acknowledged:"PotvrzenÃ©",noSyncItems:"Å½Ã¡dnÃ© poloÅ¾ky synchronizace",noSyncItemsMessage:"VygenerovanÃ© platby se zde objevÃ­, pokud jsou nakonfigurovanÃ© webhooky",queueItems:"PoloÅ¾ky Fronty",resetAllFlags:"Resetovat VÅ¡echny PÅ™Ã­znaky",paymentId:"ID Platby",status:"Stav",attempts:"Pokusy",created:"VytvoÅ™eno",lastAttempt:"PoslednÃ­ Pokus",actions:"Akce",acknowledge:"âœ“ Potvrdit",viewError:"Zobrazit Chybu",language:"Jazyk",languageAuto:"Automaticky",languageCzech:"ÄŒeÅ¡tina",languageEnglish:"English",footerText:"SPAYD GenerÃ¡tor Plateb â€¢ VÅ¡echna data uloÅ¾ena lokÃ¡lnÄ› v prohlÃ­Å¾eÄi",loading:"NaÄÃ­tÃ¡nÃ­...",initializingApp:"Inicializace aplikace...",error:"Chyba",errorGeneratingPayment:"Chyba pÅ™i generovÃ¡nÃ­ platby",invalidIban:"NeplatnÃ½ formÃ¡t IBAN",welcomeToSpayd:"VÃ­tejte v SPAYD GenerÃ¡toru",wizardIntro:"Pro zaÄÃ¡tek potÅ™ebujete alespoÅˆ jeden bankovnÃ­ ÃºÄet a jednu udÃ¡lost.",useDemoData:"PouÅ¾Ã­t Demo Data",useDemoDataDesc:"ZaÄnÄ›te rychle se vzorovÃ½mi ÃºÄty a udÃ¡lostmi. PerfektnÃ­ pro testovÃ¡nÃ­!",createYourOwn:"VytvoÅ™it VlastnÃ­",createYourOwnDesc:"Nastavte si svÅ¯j vlastnÃ­ bankovnÃ­ ÃºÄet a udÃ¡lost od zaÄÃ¡tku.",createFirstAccount:"VytvoÅ™te SvÅ¯j PrvnÃ­ ÃšÄet",createFirstAccountDesc:"PÅ™idejte bankovnÃ­ ÃºÄet, na kterÃ½ budete pÅ™ijÃ­mat platby",createFirstEvent:"VytvoÅ™te Svou PrvnÃ­ UdÃ¡lost",createFirstEventDesc:"UdÃ¡losti pomÃ¡hajÃ­ organizovat platby podle ÃºÄelu (napÅ™. poplatky za workshopy, ÄlenstvÃ­)",continueToEvent:"PokraÄovat na UdÃ¡lost â†’",completeSetup:"DokonÄit NastavenÃ­ âœ¨",creating:"VytvÃ¡Å™enÃ­...",back:"â† ZpÄ›t",includeSpacesHelp:"Pro lepÅ¡Ã­ Äitelnost mÅ¯Å¾ete zahrnout mezery",currencyCzk:"CZK - ÄŒeskÃ¡ Koruna",currencyEur:"EUR - Euro",currencyUsd:"USD - AmerickÃ½ Dolar",currencyGbp:"GBP - BritskÃ¡ Libra",staticSymbolHelp1to4:"1-4 ÄÃ­slice pro identifikaci tÃ©to udÃ¡losti",vsModeCounterDesc:"ÄŒÃ­taÄ - AutomatickÃ© zvyÅ¡ovÃ¡nÃ­ (napÅ™. 1, 2, 3...)",vsModeTimeDesc:"ÄŒasovÃ© razÃ­tko - ZaloÅ¾eno na Äase generovÃ¡nÃ­",vsModeStaticDesc:"StatickÃ½ - VÅ¾dy stejnÃ¡ hodnota",vsModeHowToGenerate:"Jak generovat variabilnÃ­ symboly pro platby",defaultAmountOptional:"VÃ½chozÃ­ ÄŒÃ¡stka (VolitelnÃ¡)",setStandardPrice:"Nastavte standardnÃ­ cenu pro tuto udÃ¡lost",pleaseEnterValidIban:"ProsÃ­m zadejte platnÃ½ IBAN",staticSymbolMust1to4:"StatickÃ½ symbol musÃ­ mÃ­t 1-4 ÄÃ­slice",failedToLoadDemoData:"NepodaÅ™ilo se naÄÃ­st demo data: ",unknownError:"NeznÃ¡mÃ¡ chyba",failedToCreateAccount:"NepodaÅ™ilo se vytvoÅ™it ÃºÄet",failedToCreateEvent:"NepodaÅ™ilo se vytvoÅ™it udÃ¡lost",paymentQrCode:"QR KÃ³d Platby",backButton:"â† ZpÄ›t",staticSymbolSimple:"StatickÃ½ Symbol",spaydString:"SPAYD Å˜etÄ›zec",download:"StÃ¡hnout",fixed:"PevnÃ¡",messageOptional:"ZprÃ¡va (VolitelnÃ¡)",generating:"GenerovÃ¡nÃ­...",generateQrCode:"Generovat QR KÃ³d",pleaseSelectBothAccountAndEvent:"ProsÃ­m vyberte ÃºÄet i udÃ¡lost",invalidAmount:"NeplatnÃ¡ ÄÃ¡stka",failedToGeneratePayment:"NepodaÅ™ilo se vygenerovat platbu",vsGenerationMode:"ReÅ¾im GenerovÃ¡nÃ­ VS",counterCurrent:"ÄŒÃ­taÄ (aktuÃ¡lnÃ­: ",timeBasedYMDHMS:"ÄŒasovÃ½ (YYYYMMDDHHmmss)",staticValue:"StatickÃ½ (",permanentAmountLabel:"TrvalÃ¡ ÄŒÃ¡stka (VolitelnÃ¡)",messageOptionalTextarea:"VolitelnÃ¡ zprÃ¡va pro vÅ¡echny platby",messageAutoIncluded:"Tato zprÃ¡va bude automaticky zahrnuta ve vÅ¡ech platbÃ¡ch pro tuto udÃ¡lost",vs:"VS",unknown:"NeznÃ¡mÃ½",queueItemsCount:"PoloÅ¾ky Fronty",resetAllFlagsConfirm:"Resetovat vÅ¡echny pÅ™Ã­znaky synchronizace? Toto oznaÄÃ­ vÅ¡echny poloÅ¾ky jako ÄekajÃ­cÃ­.",webhookUrl2:"Webhook URL"},Ee={appTitle:"SPAYD Payment Generator",appSubtitle:"Multi-account payment QR code system with automatic symbol generation",tabGenerate:"Generate",tabAccounts:"Accounts",tabEvents:"Events",tabHistory:"History",tabSync:"Sync",add:"Add",edit:"Edit",delete:"Delete",cancel:"Cancel",create:"Create",update:"Update",save:"Save",close:"Close",view:"View",default:"Default",optional:"Optional",required:"Required",accounts:"Bank Accounts",addAccount:"+ Add Account",editAccount:"Edit Account",accountName:"Account Name",accountNamePlaceholder:"e.g., Main Business Account",iban:"IBAN",ibanPlaceholder:"CZ6508000000192000145399",ibanHelp:"Enter the IBAN without spaces (e.g., CZ6508000000192000145399)",currency:"Currency",settings:"Settings",globalSettings:"Global Settings",webhookUrl:"Webhook URL",webhookUrlPlaceholder:"https://example.com/webhook",webhookUrlHelp:"URL where payment notifications will be sent (POST request)",immediateSync:"Immediate Sync",immediateSyncHelp:"Send payment notification immediately after generation",saved:"Saved",failedToSave:"Failed to save",setAsDefault:"Set as default account",noAccountsYet:"No accounts yet",noAccountsMessage:"Add your first bank account to start generating payments",deleteAccountConfirm:"Are you sure you want to delete account",events:"Payment Events",addEvent:"+ Add Event",editEvent:"Edit Event",eventName:"Event Name",eventNamePlaceholder:"e.g., Workshop 2024",staticSymbol:"Static Symbol (SS)",staticSymbolPlaceholder:"e.g., 543",staticSymbolHelp:"Event identifier that stays constant for all payments",variableSymbolMode:"Variable Symbol Mode",vsModeCounter:"Counter (Sequential: 1, 2, 3...)",vsModeTime:"Time-based (YYYYMMDDHHmmss)",vsModeStatic:"Static (Same value)",startingCounter:"Starting Counter Value",staticVsValue:"Static VS Value",staticVsValuePlaceholder:"e.g., 123456",permanentAmount:"Permanent Amount",permanentAmountPlaceholder:"e.g., 450.00",permanentAmountHelp:"Set a recurring amount for quick payment generation",setAsDefaultEvent:"Set as default event",noEventsYet:"No events yet",noEventsMessage:"Create your first payment event to organize payments",deleteEventConfirm:"Are you sure you want to delete event",generatePayment:"Generate Payment",selection:"Selection",account:"Account",event:"Event",selectedConfiguration:"Selected Configuration",paymentDetails:"Payment Details",usePermanentAmount:"Use permanent amount",amount:"Amount",amountPlaceholder:"e.g., 450.00",message:"Message",messagePlaceholder:"e.g., Registration fee",quickGenerate:"âš¡ Quick Generate",generatedPayment:"Generated Payment",variableSymbol:"Variable Symbol",setupRequired:"Setup Required",setupRequiredMessage:"Please create at least one account and one event before generating payments.",noPaymentGenerated:"No payment generated yet",noPaymentMessage:"Fill in the form and click generate to create a payment QR code",downloadQr:"ðŸ’¾ Download QR",generateAnother:"âœ¨ Generate Another",copyToClipboard:"Copy",copiedToClipboard:"Copied to clipboard!",paymentHistory:"Payment History",filters:"Filters",allAccounts:"All Accounts",allEvents:"All Events",noPaymentsFound:"No payments found",noPaymentsMessage:"Generate your first payment to see it here",date:"Date",selectPayment:"Select a payment",selectPaymentMessage:'Click "View" on a payment to see details',downloadQrCode:"ðŸ’¾ Download QR Code",deletePaymentConfirm:"Are you sure you want to delete this payment?",syncQueue:"Sync Queue",retryFailed:"ðŸ”„ Retry Failed",processQueue:"â–¶ï¸ Process Queue",processing:"Processing...",pending:"Pending",sent:"Sent",failed:"Failed",acknowledged:"Acknowledged",noSyncItems:"No sync items",noSyncItemsMessage:"Generated payments will appear here if webhooks are configured",queueItems:"Queue Items",resetAllFlags:"Reset All Flags",paymentId:"Payment ID",status:"Status",attempts:"Attempts",created:"Created",lastAttempt:"Last Attempt",actions:"Actions",acknowledge:"âœ“ Ack",viewError:"View Error",language:"Language",languageAuto:"Automatic",languageCzech:"ÄŒeÅ¡tina",languageEnglish:"English",footerText:"SPAYD Payment Generator â€¢ All data stored locally in your browser",loading:"Loading...",initializingApp:"Initializing application...",error:"Error",errorGeneratingPayment:"Failed to generate payment",invalidIban:"Invalid IBAN format",welcomeToSpayd:"Welcome to SPAYD Generator",wizardIntro:"To get started, you need at least one bank account and one event.",useDemoData:"Use Demo Data",useDemoDataDesc:"Start quickly with sample accounts and events. Perfect for testing!",createYourOwn:"Create Your Own",createYourOwnDesc:"Set up your own bank account and event from scratch.",createFirstAccount:"Create Your First Account",createFirstAccountDesc:"Add the bank account where you'll receive payments",createFirstEvent:"Create Your First Event",createFirstEventDesc:"Events help organize payments by purpose (e.g., workshop fees, memberships)",continueToEvent:"Continue to Event â†’",completeSetup:"Complete Setup âœ¨",creating:"Creating...",back:"â† Back",includeSpacesHelp:"Include spaces for easier reading",currencyCzk:"CZK - Czech Koruna",currencyEur:"EUR - Euro",currencyUsd:"USD - US Dollar",currencyGbp:"GBP - British Pound",staticSymbolHelp1to4:"1-4 digits to identify this event",vsModeCounterDesc:"Counter - Auto-increment (e.g., 1, 2, 3...)",vsModeTimeDesc:"Timestamp - Based on generation time",vsModeStaticDesc:"Static - Always the same value",vsModeHowToGenerate:"How to generate variable symbols for payments",defaultAmountOptional:"Default Amount (Optional)",setStandardPrice:"Set a standard price for this event",pleaseEnterValidIban:"Please enter a valid IBAN",staticSymbolMust1to4:"Static symbol must be 1-4 digits",failedToLoadDemoData:"Failed to load demo data: ",unknownError:"Unknown error",failedToCreateAccount:"Failed to create account",failedToCreateEvent:"Failed to create event",paymentQrCode:"Payment QR Code",backButton:"â† Back",staticSymbolSimple:"Static Symbol",spaydString:"SPAYD String",download:"Download",fixed:"Fixed",messageOptional:"Message (Optional)",generating:"Generating...",generateQrCode:"Generate QR Code",pleaseSelectBothAccountAndEvent:"Please select both account and event",invalidAmount:"Invalid amount",failedToGeneratePayment:"Failed to generate payment",vsGenerationMode:"VS Generation Mode",counterCurrent:"Counter (current: ",timeBasedYMDHMS:"Time-based (YYYYMMDDHHmmss)",staticValue:"Static (",permanentAmountLabel:"Permanent Amount (Optional)",messageOptionalTextarea:"Optional message for all payments",messageAutoIncluded:"This message will be automatically included in all payments for this event",vs:"VS",unknown:"Unknown",queueItemsCount:"Queue Items",resetAllFlagsConfirm:"Reset all sync flags? This will mark all items as pending.",webhookUrl2:"Webhook URL"},Re={cs:Be,en:Ee};function se(){return(navigator.language||navigator.userLanguage).toLowerCase().startsWith("cs")?"cs":"en"}function K(t){return Re[t]}const he={accounts:[{name:"HlavnÃ­ FiremnÃ­ ÃšÄet",iban:"CZ6508000000192000145399",currency:"CZK",isDefault:!0},{name:"PÅ™Ã­jmy z WorkshopÅ¯",iban:"CZ9401000000120320000012",currency:"CZK",isDefault:!1},{name:"MezinÃ¡rodnÃ­ ÃšÄet",iban:"SK3112000000198742637541",currency:"EUR",isDefault:!1}],events:[{name:"Workshop 2024",staticSymbol:"543",vsMode:"counter",permanentAmount:450,message:"Registrace na workshop",isDefault:!0},{name:"ÄŒlenskÃ© PÅ™Ã­spÄ›vky",staticSymbol:"777",vsMode:"time",permanentAmount:300,isDefault:!1},{name:"JednorÃ¡zovÃ© Platby",staticSymbol:"999",vsMode:"static",vsStaticValue:"1",isDefault:!1}]},ge={accounts:[{name:"Main Business Account",iban:"CZ6508000000192000145399",currency:"CZK",isDefault:!0},{name:"Workshop Revenue",iban:"CZ9401000000120320000012",currency:"CZK",isDefault:!1},{name:"International Account",iban:"SK3112000000198742637541",currency:"EUR",isDefault:!1}],events:[{name:"Workshop 2024",staticSymbol:"543",vsMode:"counter",permanentAmount:450,message:"Workshop registration fee",isDefault:!0},{name:"Membership Fees",staticSymbol:"777",vsMode:"time",permanentAmount:300,isDefault:!1},{name:"One-time Payments",staticSymbol:"999",vsMode:"static",vsStaticValue:"1",isDefault:!1}]},_e={cs:he,en:ge},$e=Object.freeze(Object.defineProperty({__proto__:null,cs:he,default:_e,en:ge},Symbol.toStringTag,{value:"Module"}));let H=null;const Me=$e;async function C(){if(H)return H;const t="spayd-db",a=4;return new Promise((n,r)=>{const l=indexedDB.open(t,a);l.onerror=()=>{r(new Error("Failed to open database"))},l.onsuccess=()=>{H=l.result,n(H)},l.onupgradeneeded=c=>{const o=c.target.result,s=c.target.transaction;if(o.objectStoreNames.contains("accounts")||o.createObjectStore("accounts",{keyPath:"id",autoIncrement:!0}).createIndex("isDefault","isDefault",{unique:!1}),o.objectStoreNames.contains("events")||o.createObjectStore("events",{keyPath:"id",autoIncrement:!0}).createIndex("isDefault","isDefault",{unique:!1}),!o.objectStoreNames.contains("payments")){const d=o.createObjectStore("payments",{keyPath:"id",autoIncrement:!0});d.createIndex("accountId","accountId",{unique:!1}),d.createIndex("eventId","eventId",{unique:!1}),d.createIndex("createdAt","createdAt",{unique:!1})}if(!o.objectStoreNames.contains("syncQueue")){const d=o.createObjectStore("syncQueue",{keyPath:"id",autoIncrement:!0});d.createIndex("paymentId","paymentId",{unique:!1}),d.createIndex("status","status",{unique:!1})}if(o.objectStoreNames.contains("settings")||o.createObjectStore("settings",{keyPath:"key"}),c.oldVersion<4&&s){const d=s.objectStore("accounts"),i=s.objectStore("settings"),p=d.getAll();p.onsuccess=()=>{const y=p.result.find(A=>A.webhookUrl);y&&y.webhookUrl&&(console.log("[DB] Migrating webhook URL to global settings:",y.webhookUrl),i.put({key:"webhookUrl",value:y.webhookUrl}))}}}})}async function pe(t){const a=await C();return new Promise((n,r)=>{const o=a.transaction(t,"readonly").objectStore(t).getAll();o.onsuccess=()=>n(o.result),o.onerror=()=>r(o.error)})}async function O(t,a){const n=await C();return new Promise((r,l)=>{const s=n.transaction(t,"readonly").objectStore(t).get(a);s.onsuccess=()=>r(s.result),s.onerror=()=>l(s.error)})}async function q(t,a){const n=await C();return new Promise((r,l)=>{const s=n.transaction(t,"readwrite").objectStore(t).add(a);s.onsuccess=()=>r(s.result),s.onerror=()=>l(s.error)})}async function X(t,a){const n=await C();return new Promise((r,l)=>{const s=n.transaction(t,"readwrite").objectStore(t).put(a);s.onsuccess=()=>r(),s.onerror=()=>l(s.error)})}async function ee(t,a){const n=await C();return new Promise((r,l)=>{const s=n.transaction(t,"readwrite").objectStore(t).delete(a);s.onsuccess=()=>r(),s.onerror=()=>l(s.error)})}async function M(){return pe("accounts")}async function Ze(t){return O("accounts",t)}async function te(t){return q("accounts",t)}async function Ge(t){if(!t.id)throw new Error("Account ID is required for update");return t.updatedAt=Date.now(),X("accounts",t)}async function Fe(t){return ee("accounts",t)}async function Z(){return pe("events")}async function Te(t){return O("events",t)}async function ae(t){return q("events",t)}async function be(t){if(!t.id)throw new Error("Event ID is required for update");return t.updatedAt=Date.now(),X("events",t)}async function Ue(t){return ee("events",t)}async function ze(t){console.log("[DB] Getting payments with filters",t);const a=await C();return new Promise((n,r)=>{const c=a.transaction("payments","readonly").objectStore("payments");let o;t!=null&&t.accountId?o=c.index("accountId").getAll(t.accountId):t!=null&&t.eventId?o=c.index("eventId").getAll(t.eventId):o=c.getAll(),o.onsuccess=()=>{let s=o.result;t!=null&&t.accountId&&(t!=null&&t.eventId)&&(s=s.filter(d=>d.accountId===t.accountId&&d.eventId===t.eventId)),s.sort((d,i)=>i.createdAt-d.createdAt),n(s)},o.onerror=()=>r(o.error)})}async function Ve(t){console.log("[DB] Adding payment to IndexedDB",t);const a=await q("payments",t);return console.log("[DB] Payment added with ID:",a),a}async function He(t){return ee("payments",t)}async function F(t){const a=await C();return new Promise((n,r)=>{const c=a.transaction("syncQueue","readonly").objectStore("syncQueue");let o;t?o=c.index("status").getAll(t):o=c.getAll(),o.onsuccess=()=>n(o.result),o.onerror=()=>r(o.error)})}async function Qe(t){return q("syncQueue",t)}async function Q(t,a,n){const r=await O("syncQueue",t);if(!r)throw new Error("Sync queue item not found");return r.status=a,r.lastAttempt=Date.now(),r.attempts=(r.attempts||0)+1,a==="acked"&&(r.ackedAt=Date.now()),n&&(r.error=n),X("syncQueue",r)}async function je(t){const a=await F(),n=await C();return new Promise((r,l)=>{const o=n.transaction("syncQueue","readwrite").objectStore("syncQueue");let s=a;t!=null&&t.fromPaymentId&&!t.global?O("payments",t.fromPaymentId).then(d=>{d&&(s=a.filter(i=>i.createdAt>=d.createdAt),ce(o,s,r,l))}):ce(o,s,r,l)})}function ce(t,a,n,r){a.forEach(l=>{l.status="pending",l.attempts=0,l.lastAttempt=void 0,l.ackedAt=void 0,l.error=void 0;const c=t.put(l);c.onerror=()=>r(c.error)}),n()}async function T(t){const a=await C();return new Promise((n,r)=>{const o=a.transaction("settings","readonly").objectStore("settings").get(t);o.onsuccess=()=>{const s=o.result;n(s?s.value:void 0)},o.onerror=()=>r(o.error)})}async function W(t,a){const n=await C();return new Promise((r,l)=>{const s=n.transaction("settings","readwrite").objectStore("settings").put({key:t,value:a});s.onsuccess=()=>r(),s.onerror=()=>l(s.error)})}async function Oe(t="en"){console.log("[DB] Adding sample data for locale:",t);const a=Date.now(),n=Me[t];if(!n){console.error("[DB] Sample data not found for locale:",t);return}const r=await M(),l=await Z();let c=0,o=0,s=0,d=0;for(const i of n.accounts)if(r.some(b=>b.iban===i.iban))console.log("[DB] Skipping existing account (IBAN exists):",i.name),o++;else try{await te({...i,createdAt:a,updatedAt:a}),c++,console.log("[DB] Added sample account:",i.name)}catch(b){console.log("[DB] Failed to add sample account (conflict?):",i.name,b),o++}for(const i of n.events)if(l.some(b=>b.staticSymbol===i.staticSymbol))console.log("[DB] Skipping existing event (static symbol exists):",i.name),d++;else try{await ae({...i,vsCounter:i.vsCounter||1,createdAt:a,updatedAt:a}),s++,console.log("[DB] Added sample event:",i.name)}catch(b){console.log("[DB] Failed to add sample event (conflict?):",i.name,b),d++}console.log(`[DB] Sample data complete: ${c} accounts added (${o} skipped), ${s} events added (${d} skipped)`)}const ve=ke(null);function qe({children:t}){const[a,n]=g("en"),[r,l]=g("auto"),[c,o]=g(K("en"));E(()=>{s()},[]);async function s(){console.log("[I18n] Loading language preference from IndexedDB");const i=await T("language");console.log("[I18n] Saved language preference:",i);let p;i==="auto"||!i?(p=se(),console.log("[I18n] Using auto-detected language:",p)):(p=i,console.log("[I18n] Using saved language:",p)),l(i||"auto"),n(p),o(K(p)),console.log("[I18n] Applied locale:",p)}async function d(i){console.log("[I18n] Setting new locale preference:",i),await W("language",i),console.log("[I18n] Saved to IndexedDB");const p=i==="auto"?se():i;console.log("[I18n] Effective locale:",p),l(i),n(p),o(K(p)),console.log("[I18n] Applied translations for:",p)}return e(ve.Provider,{value:{locale:a,savedPreference:r,t:c,setLocale:d},children:t})}function B(){const t=xe(ve);if(!t)throw new Error("useI18n must be used within I18nProvider");return t}/*!
 * @license
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. *//**
 * Validation, extraction and creation of IBAN, BBAN, BIC/SWIFT numbers plus some other helpful stuff
 * @package Documentation
 * @author SaÅ¡a JovaniÄ‡
 * @module ibantools
 * @version 4.3.4
 * @license MPL-2.0
 * @preferred
 */function ye(t,a){if(a===void 0&&(a={allowQRIBAN:!0}),t==null)return!1;var n=new RegExp("^[0-9]{2}$",""),r=t.slice(0,2),l=Ne[r];return l===void 0||l.bban_regexp===void 0||l.bban_regexp===null||l.chars===void 0?!1:l.chars===t.length&&n.test(t.slice(2,4))&&Le(t.slice(4),r)&&We(t)&&(a.allowQRIBAN||!Ye(t))}var oe;(function(t){t[t.NoIBANProvided=0]="NoIBANProvided",t[t.NoIBANCountry=1]="NoIBANCountry",t[t.WrongBBANLength=2]="WrongBBANLength",t[t.WrongBBANFormat=3]="WrongBBANFormat",t[t.ChecksumNotNumber=4]="ChecksumNotNumber",t[t.WrongIBANChecksum=5]="WrongIBANChecksum",t[t.WrongAccountBankBranchChecksum=6]="WrongAccountBankBranchChecksum",t[t.QRIBANNotAllowed=7]="QRIBANNotAllowed"})(oe||(oe={}));function Le(t,a){if(t==null||a===void 0||a===null)return!1;var n=Ne[a];return n==null||n.bban_regexp===void 0||n.bban_regexp===null||n.chars===void 0||n.chars===null?!1:n.chars-4===t.length&&Ke(t,n.bban_regexp)?n.bban_validation_func?n.bban_validation_func(t.replace(/[\s.]+/g,"")):!0:!1}function Ye(t){if(t==null)return!1;var a=t.slice(0,2),n=["LI","CH"];if(!n.includes(a))return!1;var r=new RegExp("^3[0-1]{1}[0-9]{3}$","");return r.test(t.slice(4,9))}function Ke(t,a){var n=new RegExp(a,"");return n.test(t)}function fe(t){return typeof t!="string"?null:t.replace(/[-\ ]/g,"").toUpperCase()}function Ae(t,a){if(typeof t!="string")return null;a==null&&(a=" ");var n=fe(t);return n===null?null:n.replace(/(.{4})(?!$)/g,"$1"+a)}function We(t){var a=t.slice(0,2),n=parseInt(t.slice(2,4),10),r=t.slice(4),l=Je("".concat(r).concat(a,"00")),c=ne(l);return 98-c===n}function Je(t){return t.split("").map(function(a){var n=a.charCodeAt(0);return n>=65?(n-55).toString():a}).join("")}var le;(function(t){t[t.NoBICProvided=0]="NoBICProvided",t[t.NoBICCountry=1]="NoBICCountry",t[t.WrongBICFormat=2]="WrongBICFormat"})(le||(le={}));var Xe=function(t){for(var a=[5,4,3,2,7,6,5,4,3,2],n=t.replace(/[\s.]+/g,""),r=parseInt(n.charAt(10),10),l=n.substring(0,10),c=0,o=0;o<10;o++)c+=parseInt(l.charAt(o),10)*a[o];var s=c%11;return r===(s===0?0:11-s)},et=function(t){var a=t.replace(/[\s.]+/g,""),n=parseInt(a.substring(0,a.length-2),10),r=parseInt(a.substring(a.length-2,a.length),10),l=n%97===0?97:n%97;return l===r},ne=function(t){for(;t.length>2;){var a=t.slice(0,6),n=parseInt(a,10);if(isNaN(n))return NaN;t=n%97+t.slice(a.length)}return parseInt(t,10)%97},$=function(t){var a=t.replace(/[\s.]+/g,""),n=ne(a);return n===1},tt=function(t){for(var a=[3,9,7,1,3,9,7],n=parseInt(t.charAt(7),10),r=t.substring(0,7),l=0,c=0;c<7;c++)l+=parseInt(r.charAt(c),10)*a[c];var o=l%10;return n===(o===0?0:10-o)},at=function(t){for(var a=[4,8,5,10,9,7,3,6],n=[1,2,4,8,5,10,9,7,3,6],r=parseInt(t.charAt(8),10),l=parseInt(t.charAt(9),10),c=t.substring(0,8),o=t.substring(10,20),s=0,d=0;d<8;d++)s+=parseInt(c.charAt(d),10)*a[d];var i=s%11;if(r!==(i===0?0:i===1?1:11-i))return!1;s=0;for(var d=0;d<10;d++)s+=parseInt(o.charAt(d),10)*n[d];return i=s%11,l===(i===0?0:i===1?1:11-i)},ie=function(t,a){for(var n=10,r=0;r<t.length;r++)n+=parseInt(t.charAt(r),10),n%10!==0&&(n=n%10),n=n*2,n=n%11;return a===(11-n===10?0:11-n)},nt=function(t){var a=parseInt(t.charAt(6),10),n=parseInt(t.charAt(16),10),r=t.substring(0,6),l=t.substring(7,16);return ie(r,a)&&ie(l,n)},de=function(t){for(var a=[10,5,8,4,2,1],n=[6,3,7,9,10,5,8,4,2,1],r=parseInt(t.charAt(9),10),l=parseInt(t.charAt(19),10),c=t.substring(4,9),o=t.substring(10,19),s=0,d=0;d<c.length;d++)s+=parseInt(c.charAt(d),10)*a[d];var i=s%11;if(r!==(i===0?0:i===1?1:11-i))return!1;s=0;for(var d=0;d<o.length;d++)s+=parseInt(o.charAt(d),10)*n[d];return i=s%11,l===(i===0?0:i===1?1:11-i)},rt=function(t){for(var a=[7,1,3,7,1,3,7,1,3,7,1,3,7],n=parseInt(t.charAt(15),10),r=t.substring(2,15),l=0,c=0;c<r.length;c++)l+=parseInt(r.charAt(c),10)*a[c];var o=l%10;return n===(o===0?0:10-o)},ue=function(t){for(var a=t.replace(/[\s.]+/g,""),n=Array.from(a),r=0;r<a.length;r++){var l=n[r].charCodeAt(0);if(l>=65)switch(l){case 65:case 74:n[r]="1";break;case 66:case 75:case 83:n[r]="2";break;case 67:case 76:case 84:n[r]="3";break;case 68:case 77:case 85:n[r]="4";break;case 69:case 78:case 86:n[r]="5";break;case 70:case 79:case 87:n[r]="6";break;case 71:case 80:case 88:n[r]="7";break;case 72:case 81:case 89:n[r]="8";break;case 73:case 82:case 90:n[r]="9";break}}var c=ne(n.join(""));return c===0},st=function(t){for(var a=[9,7,3,1,9,7,3,1,9,7,3,1,9,7,3],n=parseInt(t.charAt(7),10),r=t.substring(0,7),l=0,c=0;c<r.length;c++)l+=parseInt(r.charAt(c),10)*a[c];var o=l%10;if(n!==(o===0?0:10-o))return!1;if(l=0,t.endsWith("00000000")){for(var s=t.substring(8,15),d=parseInt(t.charAt(15),10),c=0;c<s.length;c++)l+=parseInt(s.charAt(c),10)*a[c];var i=l%10;return d===(i===0?0:10-i)}else{for(var s=t.substring(8,23),d=parseInt(t.charAt(23),10),c=0;c<s.length;c++)l+=parseInt(s.charAt(c),10)*a[c];var p=l%10;return d===(p===0?0:10-p)}},Ne={AD:{chars:24,bban_regexp:"^[0-9]{8}[A-Z0-9]{12}$",IBANRegistry:!0,SEPA:!0},AE:{chars:23,bban_regexp:"^[0-9]{3}[0-9]{16}$",IBANRegistry:!0},AF:{},AG:{},AI:{},AL:{chars:28,bban_regexp:"^[0-9]{8}[A-Z0-9]{16}$",IBANRegistry:!0},AM:{},AO:{chars:25,bban_regexp:"^[0-9]{21}$"},AQ:{},AR:{},AS:{},AT:{chars:20,bban_regexp:"^[0-9]{16}$",IBANRegistry:!0,SEPA:!0},AU:{},AW:{},AX:{chars:18,bban_regexp:"^[0-9]{14}$",IBANRegistry:!0},AZ:{chars:28,bban_regexp:"^[A-Z]{4}[A-Z0-9]{20}$",IBANRegistry:!0},BA:{chars:20,bban_regexp:"^[0-9]{16}$",bban_validation_func:$,IBANRegistry:!0},BB:{},BD:{},BE:{chars:16,bban_regexp:"^[0-9]{12}$",bban_validation_func:et,IBANRegistry:!0,SEPA:!0},BF:{chars:28,bban_regexp:"^[A-Z0-9]{2}[0-9]{22}$"},BG:{chars:22,bban_regexp:"^[A-Z]{4}[0-9]{6}[A-Z0-9]{8}$",IBANRegistry:!0,SEPA:!0},BH:{chars:22,bban_regexp:"^[A-Z]{4}[A-Z0-9]{14}$",IBANRegistry:!0},BI:{chars:27,bban_regexp:"^[0-9]{23}$"},BJ:{chars:28,bban_regexp:"^[A-Z0-9]{2}[0-9]{22}$"},BL:{chars:27,bban_regexp:"^[0-9]{10}[A-Z0-9]{11}[0-9]{2}$",IBANRegistry:!0},BM:{},BN:{},BO:{},BQ:{},BR:{chars:29,bban_regexp:"^[0-9]{23}[A-Z]{1}[A-Z0-9]{1}$",IBANRegistry:!0},BS:{},BT:{},BV:{},BW:{},BY:{chars:28,bban_regexp:"^[A-Z]{4}[0-9]{4}[A-Z0-9]{16}$",IBANRegistry:!0},BZ:{},CA:{},CC:{},CD:{},CF:{chars:27,bban_regexp:"^[0-9]{23}$"},CG:{chars:27,bban_regexp:"^[0-9]{23}$"},CH:{chars:21,bban_regexp:"^[0-9]{5}[A-Z0-9]{12}$",IBANRegistry:!0,SEPA:!0},CI:{chars:28,bban_regexp:"^[A-Z]{1}[0-9]{23}$"},CK:{},CL:{},CM:{chars:27,bban_regexp:"^[0-9]{23}$"},CN:{},CO:{},CR:{chars:22,bban_regexp:"^[0-9]{18}$",IBANRegistry:!0},CU:{},CV:{chars:25,bban_regexp:"^[0-9]{21}$"},CW:{},CX:{},CY:{chars:28,bban_regexp:"^[0-9]{8}[A-Z0-9]{16}$",IBANRegistry:!0,SEPA:!0},CZ:{chars:24,bban_regexp:"^[0-9]{20}$",bban_validation_func:de,IBANRegistry:!0,SEPA:!0},DE:{chars:22,bban_regexp:"^[0-9]{18}$",IBANRegistry:!0,SEPA:!0},DJ:{chars:27,bban_regexp:"^[0-9]{23}$"},DK:{chars:18,bban_regexp:"^[0-9]{14}$",IBANRegistry:!0,SEPA:!0},DM:{},DO:{chars:28,bban_regexp:"^[A-Z]{4}[0-9]{20}$",IBANRegistry:!0},DZ:{chars:26,bban_regexp:"^[0-9]{22}$"},EC:{},EE:{chars:20,bban_regexp:"^[0-9]{16}$",bban_validation_func:rt,IBANRegistry:!0,SEPA:!0},EG:{chars:29,bban_regexp:"^[0-9]{25}",IBANRegistry:!0},EH:{},ER:{},ES:{chars:24,bban_validation_func:at,bban_regexp:"^[0-9]{20}$",IBANRegistry:!0,SEPA:!0},ET:{},FI:{chars:18,bban_regexp:"^[0-9]{14}$",IBANRegistry:!0,SEPA:!0},FJ:{},FK:{chars:18,bban_regexp:"^[A-Z]{2}[0-9]{12}$"},FM:{},FO:{chars:18,bban_regexp:"^[0-9]{14}$",IBANRegistry:!0},FR:{chars:27,bban_regexp:"^[0-9]{10}[A-Z0-9]{11}[0-9]{2}$",bban_validation_func:ue,IBANRegistry:!0,SEPA:!0},GA:{chars:27,bban_regexp:"^[0-9]{23}$"},GB:{chars:22,bban_regexp:"^[A-Z]{4}[0-9]{14}$",IBANRegistry:!0,SEPA:!0},GD:{},GE:{chars:22,bban_regexp:"^[A-Z0-9]{2}[0-9]{16}$",IBANRegistry:!0},GF:{chars:27,bban_regexp:"^[0-9]{10}[A-Z0-9]{11}[0-9]{2}$",IBANRegistry:!0},GG:{},GH:{},GI:{chars:23,bban_regexp:"^[A-Z]{4}[A-Z0-9]{15}$",IBANRegistry:!0,SEPA:!0},GL:{chars:18,bban_regexp:"^[0-9]{14}$",IBANRegistry:!0},GM:{},GN:{},GP:{chars:27,bban_regexp:"^[0-9]{10}[A-Z0-9]{11}[0-9]{2}$",IBANRegistry:!0},GQ:{chars:27,bban_regexp:"^[0-9]{23}$"},GR:{chars:27,bban_regexp:"^[0-9]{7}[A-Z0-9]{16}$",IBANRegistry:!0,SEPA:!0},GS:{},GT:{chars:28,bban_regexp:"^[A-Z0-9]{24}$",IBANRegistry:!0},GU:{},GW:{chars:25,bban_regexp:"^[A-Z]{2}[0-9]{19}$"},GY:{},HK:{},HM:{},HN:{chars:28,bban_regexp:"^[A-Z]{4}[0-9]{20}$"},HR:{chars:21,bban_regexp:"^[0-9]{17}$",bban_validation_func:nt,IBANRegistry:!0,SEPA:!0},HT:{},HU:{chars:28,bban_regexp:"^[0-9]{24}$",bban_validation_func:st,IBANRegistry:!0,SEPA:!0},ID:{},IE:{chars:22,bban_regexp:"^[A-Z0-9]{4}[0-9]{14}$",IBANRegistry:!0,SEPA:!0},IL:{chars:23,bban_regexp:"^[0-9]{19}$",IBANRegistry:!0},IM:{},IN:{},IO:{},IQ:{chars:23,bban_regexp:"^[A-Z]{4}[0-9]{15}$",IBANRegistry:!0},IR:{chars:26,bban_regexp:"^[0-9]{22}$"},IS:{chars:26,bban_regexp:"^[0-9]{22}$",IBANRegistry:!0,SEPA:!0},IT:{chars:27,bban_regexp:"^[A-Z]{1}[0-9]{10}[A-Z0-9]{12}$",IBANRegistry:!0,SEPA:!0},JE:{},JM:{},JO:{chars:30,bban_regexp:"^[A-Z]{4}[0-9]{4}[A-Z0-9]{18}$",IBANRegistry:!0},JP:{},KE:{},KG:{},KH:{},KI:{},KM:{chars:27,bban_regexp:"^[0-9]{23}$"},KN:{},KP:{},KR:{},KW:{chars:30,bban_regexp:"^[A-Z]{4}[A-Z0-9]{22}$",IBANRegistry:!0},KY:{},KZ:{chars:20,bban_regexp:"^[0-9]{3}[A-Z0-9]{13}$",IBANRegistry:!0},LA:{},LB:{chars:28,bban_regexp:"^[0-9]{4}[A-Z0-9]{20}$",IBANRegistry:!0},LC:{chars:32,bban_regexp:"^[A-Z]{4}[A-Z0-9]{24}$",IBANRegistry:!0},LI:{chars:21,bban_regexp:"^[0-9]{5}[A-Z0-9]{12}$",IBANRegistry:!0,SEPA:!0},LK:{},LR:{},LS:{},LT:{chars:20,bban_regexp:"^[0-9]{16}$",IBANRegistry:!0,SEPA:!0},LU:{chars:20,bban_regexp:"^[0-9]{3}[A-Z0-9]{13}$",IBANRegistry:!0,SEPA:!0},LV:{chars:21,bban_regexp:"^[A-Z]{4}[A-Z0-9]{13}$",IBANRegistry:!0,SEPA:!0},LY:{chars:25,bban_regexp:"^[0-9]{21}$",IBANRegistry:!0},MA:{chars:28,bban_regexp:"^[0-9]{24}$"},MC:{chars:27,bban_regexp:"^[0-9]{10}[A-Z0-9]{11}[0-9]{2}$",bban_validation_func:ue,IBANRegistry:!0,SEPA:!0},MD:{chars:24,bban_regexp:"^[A-Z0-9]{2}[A-Z0-9]{18}$",IBANRegistry:!0},ME:{chars:22,bban_regexp:"^[0-9]{18}$",bban_validation_func:$,IBANRegistry:!0},MF:{chars:27,bban_regexp:"^[0-9]{10}[A-Z0-9]{11}[0-9]{2}$",IBANRegistry:!0},MG:{chars:27,bban_regexp:"^[0-9]{23}$"},MH:{},MK:{chars:19,bban_regexp:"^[0-9]{3}[A-Z0-9]{10}[0-9]{2}$",bban_validation_func:$,IBANRegistry:!0},ML:{chars:28,bban_regexp:"^[A-Z0-9]{2}[0-9]{22}$"},MM:{},MN:{chars:20,bban_regexp:"^[0-9]{16}$"},MO:{},MP:{},MQ:{chars:27,bban_regexp:"^[0-9]{10}[A-Z0-9]{11}[0-9]{2}$",IBANRegistry:!0},MR:{chars:27,bban_regexp:"^[0-9]{23}$",IBANRegistry:!0},MS:{},MT:{chars:31,bban_regexp:"^[A-Z]{4}[0-9]{5}[A-Z0-9]{18}$",IBANRegistry:!0,SEPA:!0},MU:{chars:30,bban_regexp:"^[A-Z]{4}[0-9]{19}[A-Z]{3}$",IBANRegistry:!0},MV:{},MW:{},MX:{},MY:{},MZ:{chars:25,bban_regexp:"^[0-9]{21}$"},NA:{},NC:{chars:27,bban_regexp:"^[0-9]{10}[A-Z0-9]{11}[0-9]{2}$",IBANRegistry:!0},NE:{chars:28,bban_regexp:"^[A-Z]{2}[0-9]{22}$"},NF:{},NG:{},NI:{chars:28,bban_regexp:"^[A-Z]{4}[0-9]{20}$"},NL:{chars:18,bban_regexp:"^[A-Z]{4}[0-9]{10}$",IBANRegistry:!0,SEPA:!0},NO:{chars:15,bban_regexp:"^[0-9]{11}$",bban_validation_func:Xe,IBANRegistry:!0,SEPA:!0},NP:{},NR:{},NU:{},NZ:{},OM:{},PA:{},PE:{},PF:{chars:27,bban_regexp:"^[0-9]{10}[A-Z0-9]{11}[0-9]{2}$",IBANRegistry:!0},PG:{},PH:{},PK:{chars:24,bban_regexp:"^[A-Z0-9]{4}[0-9]{16}$",IBANRegistry:!0},PL:{chars:28,bban_validation_func:tt,bban_regexp:"^[0-9]{24}$",IBANRegistry:!0,SEPA:!0},PM:{chars:27,bban_regexp:"^[0-9]{10}[A-Z0-9]{11}[0-9]{2}$",IBANRegistry:!0},PN:{},PR:{},PS:{chars:29,bban_regexp:"^[A-Z0-9]{4}[0-9]{21}$",IBANRegistry:!0},PT:{chars:25,bban_regexp:"^[0-9]{21}$",bban_validation_func:$,IBANRegistry:!0,SEPA:!0},PW:{},PY:{},QA:{chars:29,bban_regexp:"^[A-Z]{4}[A-Z0-9]{21}$",IBANRegistry:!0},RE:{chars:27,bban_regexp:"^[0-9]{10}[A-Z0-9]{11}[0-9]{2}$",IBANRegistry:!0},RO:{chars:24,bban_regexp:"^[A-Z]{4}[A-Z0-9]{16}$",IBANRegistry:!0,SEPA:!0},RS:{chars:22,bban_regexp:"^[0-9]{18}$",bban_validation_func:$,IBANRegistry:!0},RU:{chars:33,bban_regexp:"^[0-9]{14}[A-Z0-9]{15}$",IBANRegistry:!0},RW:{},SA:{chars:24,bban_regexp:"^[0-9]{2}[A-Z0-9]{18}$",IBANRegistry:!0},SB:{},SC:{chars:31,bban_regexp:"^[A-Z]{4}[0-9]{20}[A-Z]{3}$",IBANRegistry:!0},SD:{chars:18,bban_regexp:"^[0-9]{14}$",IBANRegistry:!0},SE:{chars:24,bban_regexp:"^[0-9]{20}$",IBANRegistry:!0,SEPA:!0},SG:{},SH:{},SI:{chars:19,bban_regexp:"^[0-9]{15}$",bban_validation_func:$,IBANRegistry:!0,SEPA:!0},SJ:{},SK:{chars:24,bban_regexp:"^[0-9]{20}$",bban_validation_func:de,IBANRegistry:!0,SEPA:!0},SL:{},SM:{chars:27,bban_regexp:"^[A-Z]{1}[0-9]{10}[A-Z0-9]{12}$",IBANRegistry:!0,SEPA:!0},SN:{chars:28,bban_regexp:"^[A-Z]{2}[0-9]{22}$"},SO:{chars:23,bban_regexp:"^[0-9]{19}$",IBANRegistry:!0},SR:{},SS:{},ST:{chars:25,bban_regexp:"^[0-9]{21}$",IBANRegistry:!0},SV:{chars:28,bban_regexp:"^[A-Z]{4}[0-9]{20}$",IBANRegistry:!0},SX:{},SY:{},SZ:{},TC:{},TD:{chars:27,bban_regexp:"^[0-9]{23}$"},TF:{chars:27,bban_regexp:"^[0-9]{10}[A-Z0-9]{11}[0-9]{2}$",IBANRegistry:!0},TG:{chars:28,bban_regexp:"^[A-Z]{2}[0-9]{22}$"},TH:{},TJ:{},TK:{},TL:{chars:23,bban_regexp:"^[0-9]{19}$",IBANRegistry:!0},TM:{},TN:{chars:24,bban_regexp:"^[0-9]{20}$",IBANRegistry:!0},TO:{},TR:{chars:26,bban_regexp:"^[0-9]{5}[A-Z0-9]{17}$",IBANRegistry:!0},TT:{},TV:{},TW:{},TZ:{},UA:{chars:29,bban_regexp:"^[0-9]{6}[A-Z0-9]{19}$",IBANRegistry:!0},UG:{},UM:{},US:{},UY:{},UZ:{},VA:{chars:22,bban_regexp:"^[0-9]{18}",IBANRegistry:!0,SEPA:!0},VC:{},VE:{},VG:{chars:24,bban_regexp:"^[A-Z0-9]{4}[0-9]{16}$",IBANRegistry:!0},VI:{},VN:{},VU:{},WF:{chars:27,bban_regexp:"^[0-9]{10}[A-Z0-9]{11}[0-9]{2}$",IBANRegistry:!0},WS:{},XK:{chars:20,bban_regexp:"^[0-9]{16}$",IBANRegistry:!0},YE:{},YT:{chars:27,bban_regexp:"^[0-9]{10}[A-Z0-9]{11}[0-9]{2}$",IBANRegistry:!0},ZA:{},ZM:{},ZW:{}};function Se({message:t,onConfirm:a,onCancel:n}){return e("div",{className:"dialog-overlay",onClick:n,children:e("div",{className:"dialog-container",onClick:r=>r.stopPropagation(),children:[e("div",{className:"dialog-icon warning",children:"âš ï¸"}),e("div",{className:"dialog-message",children:t}),e("div",{className:"dialog-actions",children:[e("button",{className:"btn btn-secondary",onClick:n,children:"Cancel"}),e("button",{className:"btn btn-danger",onClick:a,autoFocus:!0,children:"Delete"})]})]})})}function we({message:t,onClose:a}){return e("div",{className:"dialog-overlay",onClick:a,children:e("div",{className:"dialog-container",onClick:n=>n.stopPropagation(),children:[e("div",{className:"dialog-icon info",children:"â„¹ï¸"}),e("div",{className:"dialog-message",children:t}),e("div",{className:"dialog-actions",children:e("button",{className:"btn btn-primary",onClick:a,autoFocus:!0,children:"OK"})})]})})}function Ie({title:t,children:a,onClose:n}){return e("div",{className:"dialog-overlay",onClick:n,children:e("div",{className:"dialog-container modal-container",onClick:r=>r.stopPropagation(),children:[e("div",{className:"modal-header",children:[e("h3",{children:t}),e("button",{className:"close-button",onClick:n,children:"Ã—"})]}),e("div",{className:"modal-content",children:a})]})})}function ct(){const{t}=B(),[a,n]=g([]),[r,l]=g(!1),[c,o]=g(null),[s,d]=g({name:"",iban:"",currency:"CZK",isDefault:!1}),[i,p]=g(""),[b,y]=g(null);E(()=>{A()},[]);async function A(){const u=await M();n(u)}function w(u){u?(o(u),d({name:u.name,iban:u.iban,currency:u.currency,isDefault:u.isDefault})):(o(null),d({name:"",iban:"",currency:"CZK",isDefault:a.length===0})),p(""),l(!0)}function f(){l(!1),o(null),p("")}async function v(u){if(u.preventDefault(),p(""),!ye(s.iban)){p(t.invalidIban);return}try{const I={...s,updatedAt:Date.now(),createdAt:(c==null?void 0:c.createdAt)||Date.now()};c?await Ge({...I,id:c.id}):await te(I),await A(),f()}catch(I){p(I instanceof Error?I.message:t.failedToCreateAccount)}}function m(u){u.id&&y({account:u})}async function k(){b!=null&&b.account.id&&(await Fe(b.account.id),await A(),y(null))}return e("div",{className:"fade-in",children:[e("div",{className:"flex justify-between items-center mb-lg",children:[e("h2",{children:t.accounts}),e("button",{className:"btn btn-primary",onClick:()=>w(),children:t.addAccount})]}),a.length===0?e("div",{className:"empty-state",children:[e("div",{className:"empty-state-icon",children:"ðŸ¦"}),e("h3",{children:t.noAccountsYet}),e("p",{children:t.noAccountsMessage})]}):e("div",{className:"grid grid-2",children:a.map(u=>e("div",{className:"card",children:[e("div",{className:"flex justify-between items-center mb-md",children:[e("h3",{className:"text-lg",children:u.name}),u.isDefault&&e("span",{className:"badge badge-acked",children:t.default})]}),e("div",{className:"mb-sm",children:[e("div",{className:"text-sm text-secondary",children:t.iban}),e("div",{className:"font-mono text-sm",children:Ae(u.iban)||u.iban})]}),e("div",{className:"mb-sm",children:[e("div",{className:"text-sm text-secondary",children:t.currency}),e("div",{className:"text-sm",children:u.currency})]}),e("div",{className:"flex gap-sm mt-md",children:[e("button",{className:"btn btn-secondary btn-sm",onClick:()=>w(u),children:t.edit}),e("button",{className:"btn btn-danger btn-sm",onClick:()=>m(u),children:t.delete})]})]},u.id))}),r&&e("div",{className:"modal-overlay",onClick:f,children:e("div",{className:"modal",onClick:u=>u.stopPropagation(),children:[e("div",{className:"modal-header",children:[e("h2",{className:"modal-title",children:c?t.editAccount:t.addAccount.replace("+ ","")}),e("button",{className:"modal-close",onClick:f,children:"Ã—"})]}),e("form",{onSubmit:v,children:[e("div",{className:"form-group",children:[e("label",{className:"form-label",children:t.accountName}),e("input",{type:"text",value:s.name,onInput:u=>d({...s,name:u.target.value}),placeholder:t.accountNamePlaceholder,required:!0})]}),e("div",{className:"form-group",children:[e("label",{className:"form-label",children:t.iban}),e("input",{type:"text",value:s.iban,onInput:u=>d({...s,iban:u.target.value}),placeholder:t.ibanPlaceholder,required:!0}),e("div",{className:"form-help",children:t.ibanHelp})]}),e("div",{className:"form-group",children:[e("label",{className:"form-label",children:t.currency}),e("select",{value:s.currency,onChange:u=>d({...s,currency:u.target.value}),children:[e("option",{value:"CZK",children:"CZK"}),e("option",{value:"EUR",children:"EUR"}),e("option",{value:"USD",children:"USD"})]})]}),e("div",{className:"form-group",children:e("label",{className:"flex items-center gap-sm",children:[e("input",{type:"checkbox",checked:s.isDefault,onChange:u=>d({...s,isDefault:u.target.checked})}),e("span",{className:"form-label",style:{marginBottom:0},children:t.setAsDefault})]})}),i&&e("div",{className:"form-error mb-md",children:i}),e("div",{className:"flex gap-sm justify-between",children:[e("button",{type:"button",className:"btn btn-secondary",onClick:f,children:t.cancel}),e("button",{type:"submit",className:"btn btn-primary",children:[c?t.update:t.create," ",t.account]})]})]})]})}),b&&e(Se,{message:`${t.deleteAccountConfirm} "${b.account.name}"?`,onConfirm:k,onCancel:()=>y(null)})]})}function ot(){const{t}=B(),[a,n]=g([]),[r,l]=g(!1),[c,o]=g(null),[s,d]=g({name:"",staticSymbol:"",vsMode:"counter",vsCounter:1,vsStaticValue:"",permanentAmount:"",message:"",isDefault:!1}),[i,p]=g(null);E(()=>{b()},[]);async function b(){const m=await Z();n(m)}function y(m){var k;m?(o(m),d({name:m.name,staticSymbol:m.staticSymbol,vsMode:m.vsMode,vsCounter:m.vsCounter,vsStaticValue:m.vsStaticValue||"",permanentAmount:((k=m.permanentAmount)==null?void 0:k.toString())||"",message:m.message||"",isDefault:m.isDefault})):(o(null),d({name:"",staticSymbol:"",vsMode:"counter",vsCounter:1,vsStaticValue:"",permanentAmount:"",message:"",isDefault:a.length===0})),l(!0)}function A(){l(!1),o(null)}async function w(m){m.preventDefault();const k={...s,permanentAmount:s.permanentAmount?parseFloat(s.permanentAmount):void 0,message:s.message||void 0,updatedAt:Date.now(),createdAt:(c==null?void 0:c.createdAt)||Date.now()};c?await be({...k,id:c.id}):await ae(k),await b(),A()}function f(m){m.id&&p({event:m})}async function v(){i!=null&&i.event.id&&(await Ue(i.event.id),await b(),p(null))}return e("div",{className:"fade-in",children:[e("div",{className:"flex justify-between items-center mb-lg",children:[e("h2",{children:t.events}),e("button",{className:"btn btn-primary",onClick:()=>y(),children:t.addEvent})]}),a.length===0?e("div",{className:"empty-state",children:[e("div",{className:"empty-state-icon",children:"ðŸ“…"}),e("h3",{children:t.noEventsYet}),e("p",{children:t.noEventsMessage})]}):e("div",{className:"grid grid-2",children:a.map(m=>e("div",{className:"card",children:[e("div",{className:"flex justify-between items-center mb-md",children:[e("h3",{className:"text-lg",children:m.name}),m.isDefault&&e("span",{className:"badge badge-acked",children:t.default})]}),e("div",{className:"mb-sm",children:[e("div",{className:"text-sm text-secondary",children:t.staticSymbol}),e("div",{className:"font-mono text-sm",children:m.staticSymbol})]}),e("div",{className:"mb-sm",children:[e("div",{className:"text-sm text-secondary",children:t.vsGenerationMode}),e("div",{className:"text-sm",children:[m.vsMode==="counter"&&`${t.counterCurrent}${m.vsCounter})`,m.vsMode==="time"&&t.timeBasedYMDHMS,m.vsMode==="static"&&`${t.staticValue}${m.vsStaticValue})`]})]}),m.permanentAmount&&e("div",{className:"mb-sm",children:[e("div",{className:"text-sm text-secondary",children:t.permanentAmount}),e("div",{className:"text-sm font-semibold",children:[m.permanentAmount," CZK"]})]}),m.message&&e("div",{className:"mb-sm",children:[e("div",{className:"text-sm text-secondary",children:t.message}),e("div",{className:"text-sm",children:m.message})]}),e("div",{className:"flex gap-sm mt-md",children:[e("button",{className:"btn btn-secondary btn-sm",onClick:()=>y(m),children:t.edit}),e("button",{className:"btn btn-danger btn-sm",onClick:()=>f(m),children:t.delete})]})]},m.id))}),r&&e("div",{className:"modal-overlay",onClick:A,children:e("div",{className:"modal",onClick:m=>m.stopPropagation(),children:[e("div",{className:"modal-header",children:[e("h2",{className:"modal-title",children:c?t.editEvent:t.addEvent.replace("+ ","")}),e("button",{className:"modal-close",onClick:A,children:"Ã—"})]}),e("form",{onSubmit:w,children:[e("div",{className:"form-group",children:[e("label",{className:"form-label",children:t.eventName}),e("input",{type:"text",value:s.name,onInput:m=>d({...s,name:m.target.value}),placeholder:t.eventNamePlaceholder,required:!0})]}),e("div",{className:"form-group",children:[e("label",{className:"form-label",children:t.staticSymbol}),e("input",{type:"text",value:s.staticSymbol,onInput:m=>d({...s,staticSymbol:m.target.value}),placeholder:t.staticSymbolPlaceholder,required:!0}),e("div",{className:"form-help",children:t.staticSymbolHelp1to4})]}),e("div",{className:"form-group",children:[e("label",{className:"form-label",children:t.variableSymbolMode}),e("select",{value:s.vsMode,onChange:m=>d({...s,vsMode:m.target.value}),children:[e("option",{value:"counter",children:t.vsModeCounterDesc}),e("option",{value:"time",children:t.vsModeTimeDesc}),e("option",{value:"static",children:t.vsModeStaticDesc})]})]}),s.vsMode==="counter"&&e("div",{className:"form-group",children:[e("label",{className:"form-label",children:t.startingCounter}),e("input",{type:"number",value:s.vsCounter,onInput:m=>d({...s,vsCounter:parseInt(m.target.value)||1}),min:"1"})]}),s.vsMode==="static"&&e("div",{className:"form-group",children:[e("label",{className:"form-label",children:t.staticVsValue}),e("input",{type:"text",value:s.vsStaticValue,onInput:m=>d({...s,vsStaticValue:m.target.value}),placeholder:t.staticVsValuePlaceholder,required:!0})]}),e("div",{className:"form-group",children:[e("label",{className:"form-label",children:t.permanentAmountLabel}),e("input",{type:"number",step:"0.01",value:s.permanentAmount,onInput:m=>d({...s,permanentAmount:m.target.value}),placeholder:t.permanentAmountPlaceholder}),e("div",{className:"form-help",children:t.setStandardPrice})]}),e("div",{className:"form-group",children:[e("label",{className:"form-label",children:t.messageOptional}),e("textarea",{value:s.message,onInput:m=>d({...s,message:m.target.value}),placeholder:t.messageOptionalTextarea,rows:2}),e("div",{className:"form-help",children:t.messageAutoIncluded})]}),e("div",{className:"form-group",children:e("label",{className:"flex items-center gap-sm",children:[e("input",{type:"checkbox",checked:s.isDefault,onChange:m=>d({...s,isDefault:m.target.checked})}),e("span",{className:"form-label",style:{marginBottom:0},children:t.setAsDefaultEvent})]})}),e("div",{className:"flex gap-sm justify-between",children:[e("button",{type:"button",className:"btn btn-secondary",onClick:A,children:t.cancel}),e("button",{type:"submit",className:"btn btn-primary",children:[c?t.update:t.create," ",t.event]})]})]})]})}),i&&e(Se,{message:`${t.deleteEventConfirm} "${i.event.name}"?`,onConfirm:v,onCancel:()=>p(null)})]})}async function j(){const t=await F("pending"),a=await F("failed");for(const n of t)await J(n);for(const n of a)n.attempts<3&&await J(n)}async function J(t){if(!t.id)throw new Error("Queue item ID is required");try{const a=await fetch(t.webhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.payload)});if(a.ok)(await a.json().catch(()=>({}))).acknowledged||a.status===200?await Q(t.id,"acked"):await Q(t.id,"sent");else throw new Error(`HTTP ${a.status}: ${a.statusText}`)}catch(a){const n=a instanceof Error?a.message:"Unknown error";await Q(t.id,"failed",n)}}async function lt(t){await Q(t,"acked")}async function it(t=3){const a=await F("failed");for(const n of a)n.attempts<t&&await J(n)}function dt(t=3e4){return j().catch(console.error),window.setInterval(()=>{j().catch(console.error)},t)}function ut(t){switch(t.vsMode){case"counter":return t.vsCounter.toString();case"time":const a=new Date,n=a.getFullYear(),r=String(a.getMonth()+1).padStart(2,"0"),l=String(a.getDate()).padStart(2,"0"),c=String(a.getHours()).padStart(2,"0"),o=String(a.getMinutes()).padStart(2,"0"),s=String(a.getSeconds()).padStart(2,"0");return`${n}${r}${l}${c}${o}${s}`;case"static":return t.vsStaticValue||"0";default:return"0"}}async function mt(t,a,n,r){console.log("[PaymentGenerator] Starting payment generation",{accountId:t,eventId:a,amount:n});const l=await Ze(t),c=await Te(a);if(console.log("[PaymentGenerator] Fetched account and event",{account:l,event:c}),!l)throw new Error("Account not found");if(!c)throw new Error("Event not found");try{let o=r==null?void 0:r.variableSymbol;o||(o=ut(c),console.log("[PaymentGenerator] Generated VS:",o),c.vsMode==="counter"&&(c.vsCounter+=1,await be(c),console.log("[PaymentGenerator] Incremented VS counter to:",c.vsCounter)));const s=(r==null?void 0:r.staticSymbol)||c.staticSymbol;console.log("[PaymentGenerator] Using SS:",s);const d=fe(l.iban);if(console.log("[PaymentGenerator] Formatted IBAN:",d),!d)throw new Error("Invalid IBAN format");const i={acc:d,am:n.toFixed(2),cc:l.currency,xvs:o,xss:s};r!=null&&r.message&&(i.msg=r.message),console.log("[PaymentGenerator] Created payment description:",i);const p=Pe(i);console.log("[PaymentGenerator] Generated SPAYD string:",p),console.log("[PaymentGenerator] Generating QR code...");const b=await Ce.toDataURL(p,{errorCorrectionLevel:"H",width:512,margin:2});console.log("[PaymentGenerator] QR code generated successfully");const y={accountId:t,eventId:a,amount:n,currency:l.currency,variableSymbol:o,staticSymbol:s,message:r==null?void 0:r.message,spaydString:p,qrCodeDataUrl:b,createdAt:Date.now()};console.log("[PaymentGenerator] Storing payment to IndexedDB",y);const A=await Ve(y);console.log("[PaymentGenerator] Payment stored with ID:",A);const w=await T("webhookUrl");w&&(console.log("[PaymentGenerator] Queuing for sync to webhook:",w),await Qe({paymentId:A,webhookUrl:w,payload:{paymentId:A,accountId:t,eventId:a,amount:n,currency:l.currency,variableSymbol:o,staticSymbol:s,message:r==null?void 0:r.message,spaydString:p,createdAt:y.createdAt},status:"pending",attempts:0,createdAt:Date.now()}),await T("immediateSync")&&(console.log("[PaymentGenerator] Immediate sync enabled, processing queue..."),j().catch(m=>console.error("[PaymentGenerator] Error during immediate sync:",m))));const f={...y,id:A};return console.log("[PaymentGenerator] Payment generation complete",f),f}catch(o){throw console.error("[PaymentGenerator] ERROR during payment generation:",o),console.error("[PaymentGenerator] Error details:",{message:o instanceof Error?o.message:"Unknown error",stack:o instanceof Error?o.stack:void 0}),o}}function ht(){const{t}=B(),[a,n]=g([]),[r,l]=g([]),[c,o]=g(null),[s,d]=g(null),[i,p]=g(""),[b,y]=g(""),[A,w]=g(!1),[f,v]=g(null),[m,k]=g(""),[u,I]=g(!1),[P,_]=g(null);E(()=>{D()},[]);async function D(){const h=await M(),N=await Z();n(h),l(N);const V=h.find(Y=>Y.isDefault)||h[0],re=N.find(Y=>Y.isDefault)||N[0];V&&o(V.id),re&&d(re.id)}const x=a.find(h=>h.id===c),S=r.find(h=>h.id===s);E(()=>{S!=null&&S.permanentAmount?p(S.permanentAmount.toString()):p(""),S!=null&&S.message?y(S.message):y("")},[S]);async function U(h){if(h.preventDefault(),!c||!s){k(t.pleaseSelectBothAccountAndEvent);return}k(""),w(!0);try{const N=parseFloat(i);if(isNaN(N)||N<=0)throw new Error(t.invalidAmount);const V=await mt(c,s,N,{message:b||void 0});v(V),await D()}catch(N){k(N instanceof Error?N.message:t.failedToGeneratePayment)}finally{w(!1)}}function L(h){navigator.clipboard.writeText(h),_(t.copiedToClipboard)}if(f)return e("div",{className:"payment-result fade-in",children:[e("div",{className:"result-header",children:[e("h2",{children:t.paymentQrCode}),e("button",{className:"btn btn-secondary btn-sm",onClick:()=>v(null),children:t.backButton})]}),e("div",{className:"result-qr",children:e("img",{src:f.qrCodeDataUrl,alt:"Payment QR Code"})}),e("div",{className:"result-details",children:[e("div",{className:"result-amount",children:[e("div",{className:"amount-value",children:[f.amount," ",f.currency]}),e("div",{className:"amount-label",children:t.amount})]}),e("div",{className:"result-info",children:[e("div",{className:"info-row",children:[e("span",{className:"info-label",children:t.variableSymbol}),e("span",{className:"info-value font-mono",children:f.variableSymbol})]}),e("div",{className:"info-row",children:[e("span",{className:"info-label",children:t.staticSymbolSimple}),e("span",{className:"info-value font-mono",children:f.staticSymbol})]}),f.message&&e("div",{className:"info-row",children:[e("span",{className:"info-label",children:t.message}),e("span",{className:"info-value",children:f.message})]})]}),e("div",{className:"spayd-string-container",children:[e("div",{className:"text-sm text-secondary mb-xs",children:t.spaydString}),e("div",{className:"spayd-string",children:[e("button",{className:"copy-button",onClick:()=>L(f.spaydString),children:t.copyToClipboard}),f.spaydString]})]})]}),e("div",{className:"result-actions",children:[e("button",{className:"btn btn-secondary",onClick:()=>{const h=document.createElement("a");h.download=`payment-${f.variableSymbol}.png`,h.href=f.qrCodeDataUrl,h.click()},children:["ðŸ’¾ ",t.download]}),e("button",{className:"btn btn-primary",onClick:()=>v(null),children:t.generateAnother})]})]});const G=(S==null?void 0:S.permanentAmount)!==void 0,z=(S==null?void 0:S.message)!==void 0;return e("div",{className:"payment-form fade-in",children:[e("form",{onSubmit:U,children:[x&&S&&e("div",{className:"selection-summary",children:[e("div",{className:"summary-row",children:[e("span",{className:"summary-icon",children:"ðŸ¦"}),e("div",{className:"summary-content",children:[e("div",{className:"summary-label",children:t.account}),e("div",{className:"summary-value",children:x.name})]})]}),e("div",{className:"summary-row",children:[e("span",{className:"summary-icon",children:"ðŸ“…"}),e("div",{className:"summary-content",children:[e("div",{className:"summary-label",children:t.event}),e("div",{className:"summary-value",children:S.name})]})]}),e("button",{type:"button",className:"change-selection-btn",onClick:()=>I(!u),title:"Change account or event",children:"âš™ï¸"})]}),u&&e("div",{className:"advanced-section fade-in",children:[e("div",{className:"form-group",children:[e("label",{className:"form-label",children:t.account}),e("select",{value:c||"",onChange:h=>o(parseInt(h.target.value)),required:!0,children:a.map(h=>e("option",{value:h.id,children:[h.name," - ",Ae(h.iban)]},h.id))})]}),e("div",{className:"form-group",children:[e("label",{className:"form-label",children:t.event}),e("select",{value:s||"",onChange:h=>d(parseInt(h.target.value)),required:!0,children:r.map(h=>e("option",{value:h.id,children:[h.name," (SS: ",h.staticSymbol,")"]},h.id))})]})]}),e("div",{className:"amount-input-container",children:[e("label",{className:"amount-label",children:[t.amount," (",(x==null?void 0:x.currency)||"CZK",")",G&&e("span",{className:"fixed-badge",children:t.fixed})]}),e("input",{type:"number",step:"0.01",className:"amount-input",value:i,onInput:h=>p(h.target.value),placeholder:"0.00",required:!0,disabled:G,autoFocus:!G})]}),e("div",{className:"message-section",children:e("div",{className:"form-group",children:[e("label",{className:"form-label",children:[t.messageOptional,z&&e("span",{className:"fixed-badge",children:t.fixed})]}),e("input",{type:"text",value:b,onInput:h=>y(h.target.value),placeholder:"e.g., Registration fee",disabled:z})]})}),m&&e("div",{className:"form-error mb-md",children:m}),e("button",{type:"submit",className:"btn btn-primary generate-btn",disabled:A,children:A?e(R,{children:[e("div",{className:"spinner"}),t.generating]}):e(R,{children:[e("span",{className:"btn-icon",children:"ðŸ“±"}),t.generateQrCode]})})]}),P&&e(we,{message:P,onClose:()=>_(null)})]})}function gt(){const{t}=B(),[a,n]=g([]),[r,l]=g([]),[c,o]=g([]),[s,d]=g(null),[i,p]=g(null),[b,y]=g(null);E(()=>{A()},[s,i]);async function A(){const u=await M(),I=await Z(),P=await ze({accountId:s||void 0,eventId:i||void 0});l(u),o(I),n(P)}async function w(u){u.id&&confirm(t.deletePaymentConfirm)&&(await He(u.id),await A(),(b==null?void 0:b.id)===u.id&&y(null))}function f(u){var I;return((I=r.find(P=>P.id===u))==null?void 0:I.name)||t.unknown}function v(u){var I;return((I=c.find(P=>P.id===u))==null?void 0:I.name)||t.unknown}function m(u){return new Date(u).toLocaleString()}function k(u){navigator.clipboard.writeText(u),alert(t.copiedToClipboard)}return e("div",{className:"fade-in",children:[e("h2",{className:"mb-lg",children:t.paymentHistory}),e("div",{className:"card mb-lg",children:[e("h3",{className:"mb-md",children:t.filters}),e("div",{className:"flex gap-md",children:[e("div",{className:"form-group",style:{flex:1,marginBottom:0},children:[e("label",{className:"form-label",children:t.account}),e("select",{value:s||"",onChange:u=>d(u.target.value?parseInt(u.target.value):null),children:[e("option",{value:"",children:t.allAccounts}),r.map(u=>e("option",{value:u.id,children:u.name},u.id))]})]}),e("div",{className:"form-group",style:{flex:1,marginBottom:0},children:[e("label",{className:"form-label",children:t.event}),e("select",{value:i||"",onChange:u=>p(u.target.value?parseInt(u.target.value):null),children:[e("option",{value:"",children:t.allEvents}),c.map(u=>e("option",{value:u.id,children:u.name},u.id))]})]})]})]}),a.length===0?e("div",{className:"empty-state",children:[e("div",{className:"empty-state-icon",children:"ðŸ“‹"}),e("h3",{children:t.noPaymentsFound}),e("p",{children:t.noPaymentsMessage})]}):e("div",{className:"table-container",children:e("table",{children:[e("thead",{children:e("tr",{children:[e("th",{children:t.date}),e("th",{children:t.account}),e("th",{children:t.event}),e("th",{children:t.amount}),e("th",{children:t.vs}),e("th",{children:t.actions})]})}),e("tbody",{children:a.map(u=>e("tr",{children:[e("td",{className:"text-sm",children:m(u.createdAt)}),e("td",{className:"text-sm",children:f(u.accountId)}),e("td",{className:"text-sm",children:v(u.eventId)}),e("td",{className:"font-semibold",children:[u.amount," ",u.currency]}),e("td",{className:"font-mono text-sm",children:u.variableSymbol}),e("td",{children:e("div",{className:"flex gap-xs",children:[e("button",{className:"btn btn-secondary btn-sm",onClick:()=>y(u),children:t.view}),e("button",{className:"btn btn-danger btn-sm",onClick:()=>w(u),children:t.delete})]})})]},u.id))})]})}),b&&e(Ie,{title:t.paymentDetails,onClose:()=>y(null),children:[e("div",{className:"qr-display mb-lg",children:e("img",{src:b.qrCodeDataUrl,alt:"Payment QR Code"})}),e("div",{className:"mb-md",children:[e("div",{className:"text-sm text-secondary mb-xs",children:t.date}),e("div",{children:m(b.createdAt)})]}),e("div",{className:"mb-md",children:[e("div",{className:"text-sm text-secondary mb-xs",children:t.account}),e("div",{children:f(b.accountId)})]}),e("div",{className:"mb-md",children:[e("div",{className:"text-sm text-secondary mb-xs",children:t.event}),e("div",{children:v(b.eventId)})]}),e("div",{className:"mb-md",children:[e("div",{className:"text-sm text-secondary mb-xs",children:t.amount}),e("div",{className:"text-xl font-bold",children:[b.amount," ",b.currency]})]}),e("div",{className:"mb-md",children:[e("div",{className:"text-sm text-secondary mb-xs",children:t.variableSymbol}),e("div",{className:"font-mono",children:b.variableSymbol})]}),e("div",{className:"mb-md",children:[e("div",{className:"text-sm text-secondary mb-xs",children:t.staticSymbolSimple}),e("div",{className:"font-mono",children:b.staticSymbol})]}),b.message&&e("div",{className:"mb-md",children:[e("div",{className:"text-sm text-secondary mb-xs",children:t.message}),e("div",{children:b.message})]}),e("div",{className:"mb-lg",children:[e("div",{className:"text-sm text-secondary mb-xs",children:t.spaydString}),e("div",{className:"spayd-string",style:{position:"relative"},children:[e("button",{className:"copy-button",onClick:()=>k(b.spaydString),children:t.copyToClipboard}),b.spaydString]})]}),e("button",{className:"btn btn-secondary",style:{width:"100%"},onClick:()=>{const u=document.createElement("a");u.download=`payment-${b.variableSymbol}.png`,u.href=b.qrCodeDataUrl,u.click()},children:t.downloadQrCode})]})]})}function pt(){const{t}=B(),[a,n]=g([]),[r,l]=g(!1);E(()=>{c();const v=setInterval(c,1e4);return()=>clearInterval(v)},[]);async function c(){const v=await F();n(v)}async function o(){l(!0);try{await j(),await c()}finally{l(!1)}}async function s(){l(!0);try{await it(3),await c()}finally{l(!1)}}async function d(){confirm(t.resetAllFlagsConfirm)&&(await je({global:!0}),await c())}async function i(v){await lt(v),await c()}function p(v){return new Date(v).toLocaleString()}function b(v){switch(v){case"pending":return"badge-pending";case"sent":return"badge-sent";case"acked":return"badge-acked";case"failed":return"badge-failed";default:return""}}function y(v){switch(v){case"pending":return t.pending;case"sent":return t.sent;case"acked":return t.acknowledged;case"failed":return t.failed;default:return v}}const A=a.filter(v=>v.status==="pending").length,w=a.filter(v=>v.status==="failed").length,f=a.filter(v=>v.status==="acked").length;return e("div",{className:"fade-in",children:[e("div",{className:"flex justify-between items-center mb-lg",children:[e("h2",{children:t.syncQueue}),e("div",{className:"flex gap-sm",children:[e("button",{className:"btn btn-secondary",onClick:s,disabled:r||w===0,children:t.retryFailed}),e("button",{className:"btn btn-primary",onClick:o,disabled:r,children:r?e(R,{children:[e("div",{className:"spinner"}),t.processing]}):t.processQueue})]})]}),e("div",{className:"grid grid-3 mb-lg",children:[e("div",{className:"card",children:[e("div",{className:"text-sm text-secondary",children:t.pending}),e("div",{className:"text-2xl font-bold",children:A})]}),e("div",{className:"card",children:[e("div",{className:"text-sm text-secondary",children:t.failed}),e("div",{className:"text-2xl font-bold",style:{color:"var(--color-danger)"},children:w})]}),e("div",{className:"card",children:[e("div",{className:"text-sm text-secondary",children:t.acknowledged}),e("div",{className:"text-2xl font-bold",style:{color:"var(--color-success)"},children:f})]})]}),a.length===0?e("div",{className:"empty-state",children:[e("div",{className:"empty-state-icon",children:"ðŸ“­"}),e("h3",{children:t.noSyncItems}),e("p",{children:t.noSyncItemsMessage})]}):e(R,{children:[e("div",{className:"flex justify-between items-center mb-md",children:[e("h3",{children:[t.queueItemsCount," (",a.length,")"]}),e("button",{className:"btn btn-danger btn-sm",onClick:d,children:t.resetAllFlags})]}),e("div",{className:"table-container",children:e("table",{children:[e("thead",{children:e("tr",{children:[e("th",{children:t.paymentId}),e("th",{children:t.status}),e("th",{children:t.attempts}),e("th",{children:t.created}),e("th",{children:t.lastAttempt}),e("th",{children:t.webhookUrl2}),e("th",{children:t.actions})]})}),e("tbody",{children:a.map(v=>e("tr",{children:[e("td",{className:"font-mono text-sm",children:["#",v.paymentId]}),e("td",{children:e("span",{className:`badge ${b(v.status)}`,children:y(v.status)})}),e("td",{children:v.attempts}),e("td",{className:"text-sm",children:p(v.createdAt)}),e("td",{className:"text-sm",children:v.lastAttempt?p(v.lastAttempt):"-"}),e("td",{className:"text-sm",style:{maxWidth:"200px",overflow:"hidden",textOverflow:"ellipsis"},children:v.webhookUrl}),e("td",{children:[v.status==="sent"&&e("button",{className:"btn btn-success btn-sm",onClick:()=>i(v.id),children:t.acknowledge}),v.status==="failed"&&v.error&&e("button",{className:"btn btn-secondary btn-sm",onClick:()=>alert(v.error),children:t.viewError})]})]},v.id))})]})})]})]})}function me(){const{savedPreference:t,t:a,setLocale:n}=B();async function r(l){const c=l.target.value;console.log("[LanguageSwitcher] User selected:",c),await n(c)}return e("div",{className:"language-switcher",style:{display:"inline-flex",alignItems:"center",gap:"var(--spacing-sm)"},children:[e("label",{htmlFor:"language-select",className:"text-sm text-secondary",children:[a.language,":"]}),e("select",{id:"language-select",value:t,onChange:r,className:"language-select",style:{minWidth:"120px"},children:[e("option",{value:"auto",children:a.languageAuto}),e("option",{value:"cs",children:a.languageCzech}),e("option",{value:"en",children:a.languageEnglish})]})]})}function bt({onClose:t}){const{t:a}=B(),[n,r]=g(""),[l,c]=g(!1),[o,s]=g(!0),[d,i]=g("idle");E(()=>{p()},[]);async function p(){try{const y=await T("webhookUrl"),A=await T("immediateSync");r(y||""),c(!!A)}catch(y){console.error("Failed to load settings:",y)}finally{s(!1)}}async function b(y){y.preventDefault(),i("saving");try{await W("webhookUrl",n),await W("immediateSync",l),i("saved"),setTimeout(()=>{t()},1e3)}catch(A){console.error("Failed to save settings:",A),i("error")}}return e(Ie,{title:a.globalSettings,onClose:t,children:o?e("div",{className:"p-md text-center",children:a.loading}):e("form",{onSubmit:b,children:[e("div",{className:"form-group",children:[e("label",{className:"form-label",children:a.webhookUrl}),e("input",{type:"url",value:n,onInput:y=>r(y.target.value),placeholder:a.webhookUrlPlaceholder,className:"form-input"}),e("div",{className:"form-help",children:a.webhookUrlHelp})]}),e("div",{className:"form-group",children:[e("label",{className:"form-label flex items-center gap-sm cursor-pointer",children:[e("input",{type:"checkbox",checked:l,onChange:y=>c(y.target.checked),className:"form-checkbox"}),a.immediateSync]}),e("div",{className:"form-help",children:a.immediateSyncHelp})]}),d==="saved"&&e("div",{className:"alert alert-success mb-md",children:a.saved}),d==="error"&&e("div",{className:"alert alert-danger mb-md",children:a.failedToSave}),e("div",{className:"flex gap-sm justify-end mt-lg",children:[e("button",{type:"button",className:"btn btn-secondary",onClick:t,children:a.cancel}),e("button",{type:"submit",className:"btn btn-primary",disabled:d==="saving",children:d==="saving"?a.processing:a.save})]})]})})}function vt({activeView:t,onNavigate:a}){const{t:n}=B(),[r,l]=g(!1),[c,o]=g(!1),s=[{id:"generate",label:n.tabGenerate,icon:"ðŸ’³"},{id:"accounts",label:n.tabAccounts,icon:"ðŸ¦"},{id:"events",label:n.tabEvents,icon:"ðŸ“…"},{id:"history",label:n.tabHistory,icon:"ðŸ“œ"},{id:"sync",label:n.tabSync,icon:"ðŸ”„"}],d=i=>{a(i),l(!1)};return e(R,{children:[e("button",{className:`hamburger-icon ${r?"open":""}`,onClick:()=>l(!r),"aria-label":"Toggle menu",children:[e("span",{className:`hamburger-line ${r?"open":""}`}),e("span",{className:`hamburger-line ${r?"open":""}`}),e("span",{className:`hamburger-line ${r?"open":""}`})]}),r&&e("div",{className:"menu-overlay",onClick:()=>l(!1)}),e("nav",{className:`slide-menu ${r?"open":""}`,children:[e("ul",{className:"menu-list",children:[s.map(i=>e("li",{children:e("button",{className:`menu-item ${t===i.id?"active":""}`,onClick:()=>d(i.id),children:[e("span",{className:"menu-icon",children:i.icon}),e("span",{className:"menu-label",children:i.label})]})},i.id)),e("li",{children:e("button",{className:"menu-item",onClick:()=>{o(!0),l(!1)},children:[e("span",{className:"menu-icon",children:"âš™ï¸"}),e("span",{className:"menu-label",children:n.settings})]})})]}),e("div",{className:"menu-footer",children:e(me,{})})]}),e("nav",{className:"desktop-menu",children:[s.map(i=>e("button",{className:`desktop-menu-item ${t===i.id?"active":""}`,onClick:()=>a(i.id),children:[e("span",{className:"menu-icon",children:i.icon}),e("span",{className:"menu-label",children:i.label})]},i.id)),e("button",{className:"desktop-menu-item",onClick:()=>o(!0),children:[e("span",{className:"menu-icon",children:"âš™ï¸"}),e("span",{className:"menu-label",children:n.settings})]}),e("div",{className:"desktop-menu-separator"}),e("div",{className:"desktop-menu-language",children:e(me,{})})]}),c&&e(bt,{onClose:()=>o(!1)})]})}function yt({onComplete:t}){const{t:a,locale:n}=B(),[r,l]=g("choice"),[c,o]=g(""),[s,d]=g(""),[i,p]=g("CZK"),[b,y]=g(""),[A,w]=g(""),[f,v]=g(""),[m,k]=g("counter"),[u,I]=g(""),[P,_]=g(""),[D,x]=g(!1),[S,U]=g(null);async function L(){x(!0);try{await Oe(n),t()}catch(h){U(a.failedToLoadDemoData+(h instanceof Error?h.message:a.unknownError)),x(!1)}}async function G(h){if(h.preventDefault(),y(""),!ye(s)){y(a.pleaseEnterValidIban);return}x(!0);try{const N=Date.now();await te({name:c,iban:s.replace(/\s/g,"").toUpperCase(),currency:i,isDefault:!0,createdAt:N,updatedAt:N}),l("event")}catch(N){y(N instanceof Error?N.message:a.failedToCreateAccount)}finally{x(!1)}}async function z(h){if(h.preventDefault(),_(""),!/^\d{1,4}$/.test(f)){_(a.staticSymbolMust1to4);return}x(!0);try{const N=Date.now();await ae({name:A,staticSymbol:f,vsMode:m,vsCounter:1,vsStaticValue:m==="static"?"1":void 0,permanentAmount:u?parseFloat(u):void 0,isDefault:!0,createdAt:N,updatedAt:N}),t()}catch(N){_(N instanceof Error?N.message:a.failedToCreateEvent)}finally{x(!1)}}return e("div",{className:"config-wizard",children:[e("div",{className:"wizard-container",children:[e("div",{className:"wizard-header",children:e("h1",{children:a.welcomeToSpayd})}),r==="choice"&&e("div",{className:"wizard-content fade-in",children:[e("p",{className:"wizard-intro",children:a.wizardIntro}),e("div",{className:"choice-container",children:[e("button",{className:"choice-card",onClick:L,disabled:D,type:"button",children:[e("div",{className:"choice-icon",children:"ðŸŽ¯"}),e("h3",{children:a.useDemoData}),e("p",{children:a.useDemoDataDesc})]}),e("button",{className:"choice-card",onClick:()=>l("account"),disabled:D,type:"button",children:[e("div",{className:"choice-icon",children:"âœï¸"}),e("h3",{children:a.createYourOwn}),e("p",{children:a.createYourOwnDesc})]})]})]}),r==="account"&&e("div",{className:"wizard-step fade-in",children:[e("div",{className:"step-icon",children:"ðŸ¦"}),e("h2",{className:"step-title",children:a.createFirstAccount}),e("p",{className:"step-description",children:a.createFirstAccountDesc}),e("form",{onSubmit:G,children:[e("div",{className:"form-group",children:[e("label",{className:"form-label",children:a.accountName}),e("input",{type:"text",value:c,onInput:h=>o(h.target.value),placeholder:a.accountNamePlaceholder,required:!0,autoFocus:!0})]}),e("div",{className:"form-group",children:[e("label",{className:"form-label",children:a.iban}),e("input",{type:"text",value:s,onInput:h=>d(h.target.value),placeholder:a.ibanPlaceholder,required:!0}),e("div",{className:"form-help",children:a.includeSpacesHelp})]}),e("div",{className:"form-group",children:[e("label",{className:"form-label",children:a.currency}),e("select",{value:i,onChange:h=>p(h.target.value),required:!0,children:[e("option",{value:"CZK",children:a.currencyCzk}),e("option",{value:"EUR",children:a.currencyEur}),e("option",{value:"USD",children:a.currencyUsd}),e("option",{value:"GBP",children:a.currencyGbp})]})]}),b&&e("div",{className:"form-error",children:b}),e("button",{type:"submit",className:"btn btn-primary btn-lg wizard-button",disabled:D,children:D?e(R,{children:[e("div",{className:"spinner"}),a.creating]}):a.continueToEvent})]})]}),r==="event"&&e("div",{className:"wizard-step fade-in",children:[e("div",{className:"step-icon",children:"ðŸ“…"}),e("h2",{className:"step-title",children:a.createFirstEvent}),e("p",{className:"step-description",children:a.createFirstEventDesc}),e("form",{onSubmit:z,children:[e("div",{className:"form-group",children:[e("label",{className:"form-label",children:a.eventName}),e("input",{type:"text",value:A,onInput:h=>w(h.target.value),placeholder:a.eventNamePlaceholder,required:!0,autoFocus:!0})]}),e("div",{className:"form-group",children:[e("label",{className:"form-label",children:a.staticSymbol}),e("input",{type:"text",value:f,onInput:h=>v(h.target.value),placeholder:a.staticSymbolPlaceholder,maxLength:4,required:!0}),e("div",{className:"form-help",children:a.staticSymbolHelp1to4})]}),e("div",{className:"form-group",children:[e("label",{className:"form-label",children:a.variableSymbolMode}),e("select",{value:m,onChange:h=>k(h.target.value),required:!0,children:[e("option",{value:"counter",children:a.vsModeCounterDesc}),e("option",{value:"time",children:a.vsModeTimeDesc}),e("option",{value:"static",children:a.vsModeStaticDesc})]}),e("div",{className:"form-help",children:a.vsModeHowToGenerate})]}),e("div",{className:"form-group",children:[e("label",{className:"form-label",children:a.defaultAmountOptional}),e("input",{type:"number",step:"0.01",value:u,onInput:h=>I(h.target.value),placeholder:a.permanentAmountPlaceholder}),e("div",{className:"form-help",children:a.setStandardPrice})]}),P&&e("div",{className:"form-error",children:P}),e("div",{className:"wizard-actions",children:[e("button",{type:"button",className:"btn btn-secondary",onClick:()=>l("account"),disabled:D,children:a.back}),e("button",{type:"submit",className:"btn btn-primary btn-lg",disabled:D,children:D?e(R,{children:[e("div",{className:"spinner"}),a.creating]}):a.completeSetup})]})]})]})]}),S&&e(we,{message:S,onClose:()=>U(null)})]})}function ft(){const{t}=B(),[a,n]=g("generate"),[r,l]=g(!1),[c,o]=g(!1);E(()=>{C().then(async()=>{const d=await M(),i=await Z();d.length===0||i.length===0?o(!0):o(!1),l(!0);const p=dt(3e4);return()=>{typeof p=="number"&&clearInterval(p)}}).catch(d=>{console.error("Failed to initialize database:",d),alert("Failed to initialize database. Please refresh the page.")})},[]);async function s(){const d=await M(),i=await Z();d.length>0&&i.length>0&&(o(!1),n("generate"))}return r?c?e(yt,{onComplete:s}):e("div",{className:"app-container",children:[e("header",{className:"app-header",children:e("div",{className:"header-content",children:[e("h1",{className:"app-title",children:t.appTitle}),e(vt,{activeView:a,onNavigate:d=>n(d)})]})}),e("main",{className:"app-main",children:[a==="generate"&&e(ht,{}),a==="accounts"&&e(ct,{}),a==="events"&&e(ot,{}),a==="history"&&e(gt,{}),a==="sync"&&e(pt,{})]}),e("footer",{className:"app-footer",children:e("p",{children:t.footerText})})]}):e("div",{className:"container",style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh"},children:e("div",{style:{textAlign:"center"},children:[e("div",{className:"spinner",style:{width:"3rem",height:"3rem",margin:"0 auto 1rem"}}),e("div",{className:"text-lg",children:t.initializingApp})]})})}De(e(qe,{children:e(ft,{})}),document.getElementById("app"));
